version: '2.4'
services:
  x11:
    image: infrastlabs/docker-headless:slim
    restart: unless-stopped
    environment:
      - SSH_PASS=headless
      - VNC_PASS=headless
      - VNC_PASS_RO=View123
      - VNC_OFFSET=30
      - VNC_LIMIT=3
    # network_mode: host
    ports:
      - "10081:10081" #novnc
      - "10089:10089" #rdp
      - "10082:10082" #audio
      - "10022:10022" #ssh
    volumes:
      - /_ext:/_ext
      - /:/mnt

  de-cinnamon:
    # image: x11docker/cinnamon
    image: registry.cn-shenzhen.aliyuncs.com/infrastlabs/docker-ubuntu-desktop-vnc:cinnamon1
    # command: tail -f /dev/null
    restart: unless-stopped
    # network_mode: host
    ports:
      - 5901:5901
      - 6080:6080
    environment:
      - DISPLAY=:31
      - PULSE_SERVER=tcp:localhost:4731
    tmpfs:
      - /run
      - /run/lock
      - /tmp
    volumes: 
      - /sys/fs/cgroup:/sys/fs/cgroup 
      - /_ext:/_ext
      - /:/mnt      
    cap_add:
      - SYS_BOOT 
      - SYS_ADMIN      